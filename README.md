# PowerPoint自動変換ツール

## 概要

PowerPointファイル（PPTX）を自動変換するツールです。

**入力PPT**: 表紙 → 問題ページ群 → 解答1枚  
**出力PPT**: 表紙 → 問題ページ群 → 解答を埋め込んだ問題ページ群 → 解答1枚

## 機能

- 解答ページから解答を自動抽出（正規表現を使用）
- 問題ページを自動複製
- 解答を新規テキストボックスとして挿入
- 既存の図形・文章には一切干渉しない

## インストール

```bash
cd c:\Users\doctor\pptmaker
pip install -r requirements.txt
```

## 使用方法

### 最も簡単な方法（推奨）

1. `convert_pptx_簡単.bat` をダブルクリック
2. ファイル選択ダイアログで変換したいPPTXファイルを選択
3. 変換完了後、同じフォルダに「元のファイル名_converted.pptx」が作成されます

### ドラッグ＆ドロップ

1. `convert_pptx.bat` を開く（ダブルクリック）
2. 変換したいPPTXファイルを `convert_pptx.bat` にドラッグ＆ドロップ

### コマンドラインから実行

```bash
cd c:\Users\doctor\pptmaker
python convert_pptx.py <入力PPTXファイル> [出力PPTXファイル]
```

**例:**
```bash
# 出力ファイル名を自動生成（入力ファイル名_converted.pptx）
python convert_pptx.py input.pptx

# 出力ファイル名を指定
python convert_pptx.py input.pptx output.pptx
```

### Pythonコードから使用

```python
from convert_pptx import convert_pptx

# 変換実行
convert_pptx("input.pptx", "output.pptx")
```

## 入力ファイルの要件

### スライド構成

1. **0枚目（表紙）**: 表紙スライド
2. **1枚目～最後の1枚前（問題ページ群）**: 大問1, 2, 3... に対応する問題ページ
3. **最後の1枚（解答ページ）**: 解答が記載されたスライド

### 解答ページの書式

解答ページには以下の形式を含む必要があります：

```
大問 1 38.608㎠
大問 2 52.685㎠
大問 3 36
大問 4 76.2㎠
大問 5 91.06ｍ
大問 6 50.24cm
```

**注意:**
- 「大問」の後に大問番号、その後に解答（数値＋単位）が続く形式
- 単位の有無は問いません
- 正規表現パターン: `大問\s*([0-9]+)\s*([^\n\r]+)`

## 出力ファイルの構成

1. **表紙**: 元の表紙（そのまま）
2. **問題ページ群**: 元の問題ページ群（そのまま）
3. **解答入り問題ページ群**: 問題ページの複製に解答を追加したもの
4. **解答ページ**: 元の解答ページ（そのまま）

## 解答の挿入仕様

### 挿入方法
- **新規テキストボックス**として挿入（既存の解答欄は使用しない）

### 内容
```
【解答】{解答文字列}
```
例: `【解答】38.608㎠`

### 配置
- **横位置**: スライド中央揃え
- **縦位置**: スライド下部（高さの82%の位置）

### フォント設定
- **サイズ**: 15pt
- **色**: 黒
- **太字**: 有効
- **配置**: 中央揃え

## エラー処理

- 解答が存在しない大問番号の場合: `【解答】（未設定）` を表示
- 問題ページ数と解答数がズレていても処理は続行
- スライドが2枚未満の場合: エラーを表示

## 注意事項

1. **既存の解答欄は使用しません**: すべて新規テキストボックスで挿入されます
2. **単位の有無は無視**: 解答文字列をそのまま使用します
3. **レイアウトの保持**: 可能な限り元のスライドのレイアウトを保持しますが、スライドマスターが異なる場合、一部の設定が失われる可能性があります

## トラブルシューティング

### スライドが正しく複製されない場合

python-pptxの制約により、一部の複雑なスライド（アニメーション、特殊な図形など）が正しく複製されない場合があります。その場合は、元のPPTXファイルの構造を確認してください。

### 解答が抽出されない場合

解答ページの書式を確認してください。正規表現パターン `大問\s*([0-9]+)\s*([^\n\r]+)` に一致する必要があります。

## ライセンス

このツールは内部使用を目的としています。

